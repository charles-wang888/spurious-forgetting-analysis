# è™šå‡é—å¿˜è¯†åˆ«ä¸ç¼“è§£æœºåˆ¶å®éªŒä»£ç 

## ğŸ“‹ ç›®å½•

- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
- [ç¯å¢ƒå‡†å¤‡](#ç¯å¢ƒå‡†å¤‡)
- [è¿è¡Œå®éªŒ](#è¿è¡Œå®éªŒ)
- [å®éªŒç»„è¯´æ˜](#å®éªŒç»„è¯´æ˜)
- [å®éªŒç»“æœ](#å®éªŒç»“æœ)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 3æ­¥å¿«é€Ÿè¿è¡Œ

1. **å®‰è£…ä¾èµ–**ï¼š`pip install -r requirements.txt`
2. **å®‰è£…Ollama**ï¼šè®¿é—® https://ollama.ai ä¸‹è½½å®‰è£…ï¼Œç„¶åè¿è¡Œ `ollama serve`
3. **æ‹‰å–æ¨¡å‹**ï¼š`ollama pull qwen2.5:3b`ï¼ˆæˆ–ä½¿ç”¨å®Œæ•´4ä¸ªæ¨¡å‹ï¼‰
4. **è¿è¡Œå®éªŒ**ï¼š`python run_experiments.py`

### æ£€æŸ¥ç¯å¢ƒ

```bash
# æ£€æŸ¥Ollamaè¿æ¥å’Œæ¨¡å‹
python run_experiments.py --check-ollama
```

---

## é¡¹ç›®æ¦‚è¿°

æœ¬å®éªŒä»£ç åº“å®ç°äº†è™šå‡é—å¿˜è¯†åˆ«ä¸ç¼“è§£æœºåˆ¶çš„æ ¸å¿ƒå®éªŒï¼ŒåŒ…æ‹¬ï¼š

1. **è™šå‡é—å¿˜è¯†åˆ«éªŒè¯**ï¼šéªŒè¯æå‡ºçš„è™šå‡é—å¿˜è¯†åˆ«æŒ‡æ ‡å’Œåˆ†æå·¥å…·çš„æœ‰æ•ˆæ€§
2. **æ·±å±‚å¯¹é½è®­ç»ƒéªŒè¯**ï¼šéªŒè¯æ·±å±‚å¯¹é½è®­ç»ƒï¼ˆDeep Alignment Trainingï¼‰çš„æœ‰æ•ˆæ€§
3. **æ¶ˆèå®éªŒ**ï¼šåˆ†æå„ä¸ªç»„ä»¶çš„è´¡çŒ®ï¼ŒéªŒè¯æ–¹æ³•è®¾è®¡çš„åˆç†æ€§

### æ ¸å¿ƒç‰¹æ€§

- âœ… ä½¿ç”¨Ollamaéƒ¨ç½²çš„4ä¸ªQwenæ¨¡å‹ï¼ˆ1.7B, 3B, 4B, 32Bï¼‰
- âœ… å®ç°æ·±å±‚å¯¹é½è®­ç»ƒï¼ˆDeep Alignment Trainingï¼‰
- âœ… å®ç°è‡ªé€‚åº”ç¼“è§£ç­–ç•¥ï¼ˆAdaptive Mitigationï¼‰
- âœ… ç»Ÿä¸€çš„å®éªŒå…¥å£ï¼ˆ`run_experiments.py`ï¼‰

---

## ç¯å¢ƒå‡†å¤‡

### å‰ç½®è¦æ±‚

- Python 3.8+
- Ollamaï¼ˆç”¨äºè¿è¡ŒQwenæ¨¡å‹ï¼‰
- CUDAï¼ˆå¯é€‰ï¼Œç”¨äºGPUåŠ é€Ÿï¼‰

### 1. å®‰è£…Pythonä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. å®‰è£…å’Œé…ç½®Ollama

#### Windows:
1. è®¿é—® https://ollama.ai/download ä¸‹è½½å¹¶å®‰è£…
2. æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¿è¡Œï¼š
```bash
ollama serve
```

#### Linux/Mac:
```bash
curl -fsSL https://ollama.ai/install.sh | sh
ollama serve
```

### 3. æ‹‰å–æ¨¡å‹

```bash
ollama pull qwen3:1.7b
ollama pull qwen2.5:3b
ollama pull qwen3:4b
ollama pull qwen2.5:32b
```

**æ³¨æ„**ï¼š32Bæ¨¡å‹è¾ƒå¤§ï¼ˆçº¦18GBï¼‰ï¼Œå¦‚æœèµ„æºæœ‰é™å¯ä»¥å…ˆåªæ‹‰å–è¾ƒå°çš„æ¨¡å‹ã€‚

### 4. æ£€æŸ¥Ollamaè®¾ç½®

```bash
python run_experiments.py --check-ollama
```

---

## è¿è¡Œå®éªŒ

### åŸºæœ¬è¿è¡Œ

è¿è¡Œæ‰€æœ‰å®éªŒï¼ˆä½¿ç”¨æ‰€æœ‰4ä¸ªæ¨¡å‹å’Œæ‰€æœ‰å®éªŒç»„ï¼‰ï¼š

```bash
python run_experiments.py
```

### æŒ‡å®šå‚æ•°

```bash
# ä½¿ç”¨ç‰¹å®šæ¨¡å‹
python run_experiments.py --models qwen2.5:3b qwen3:4b

# ä½¿ç”¨ç‰¹å®šæ•°æ®é›†
python run_experiments.py --datasets clinc150

# è¿è¡Œç‰¹å®šå®éªŒç»„
python run_experiments.py --experiment-groups baseline_control ablation

# ä½¿ç”¨CPUï¼ˆå¦‚æœæ²¡æœ‰GPUï¼‰
python run_experiments.py --device cpu

# ç¦ç”¨æ·±å±‚å¯¹é½è®­ç»ƒï¼ˆç”¨äºå¯¹æ¯”å®éªŒï¼‰
python run_experiments.py --no-deep-alignment

# ç¦ç”¨æ··åˆç­–ç•¥ï¼ˆç”¨äºå¯¹æ¯”å®éªŒï¼‰
python run_experiments.py --no-hybrid-strategy
```

### ç»„åˆä½¿ç”¨

```bash
# è¿è¡Œå®Œæ•´å®éªŒï¼ˆæ·±å±‚å¯¹é½è®­ç»ƒ + æ··åˆç­–ç•¥ï¼‰
python run_experiments.py \
    --use-deep-alignment \
    --use-hybrid-strategy \
    --datasets clinc150 20newsgroups \
    --models qwen2.5:3b qwen2.5:32b
```

---

## å®éªŒç»„è¯´æ˜

### å®éªŒç»„1ï¼šåŸºçº¿å¯¹ç…§ç»„ï¼ˆBaseline Control Groupï¼‰

**å®éªŒç›®çš„**ï¼š
- è§‚å¯Ÿè‡ªç„¶çŠ¶æ€ä¸‹çš„é—å¿˜æƒ…å†µï¼Œå»ºç«‹åŸºçº¿
- è¯„ä¼°æ ‡å‡†æŒç»­å­¦ä¹ æ–¹æ³•çš„æ€§èƒ½ä¸‹é™æƒ…å†µ

**è¿è¡Œå‘½ä»¤**ï¼š
```bash
python run_experiments.py \
  --models qwen2.5:3b \
  --datasets clinc150 \
  --experiment-groups baseline_control
```

**å…³é”®å‚æ•°**ï¼š
- å®éªŒç»„åç§°ï¼š`baseline_control`
- è®­ç»ƒç­–ç•¥ï¼šæ ‡å‡†è®­ç»ƒï¼Œæ— ç¼“è§£ç­–ç•¥
- æ— å†»ç»“å±‚
- æ— æ·±å±‚å¯¹é½è®­ç»ƒ

### å®éªŒç»„2ï¼šè™šå‡é—å¿˜è¯±å¯¼ç»„ï¼ˆSpurious Forgetting Induced Groupï¼‰

**å®éªŒç›®çš„**ï¼š
- é€šè¿‡å†»ç»“åº•å±‚30%å±‚ï¼Œè¯±å¯¼è™šå‡é—å¿˜
- éªŒè¯è™šå‡é—å¿˜çš„ç‰¹å¾ï¼šè¡¨ç¤ºç©ºé—´å˜åŒ–å°ï¼Œä½†æ€§èƒ½ä¸‹é™å¤§
- éªŒè¯å¯é€†æ€§åˆ†æ•°åº”è¯¥è¾ƒé«˜ï¼ˆ>0.6ï¼‰

**è¿è¡Œå‘½ä»¤**ï¼š
```bash
python run_experiments.py \
  --models qwen2.5:3b \
  --datasets clinc150 \
  --experiment-groups spurious_forgetting_induced
```

**å…³é”®å‚æ•°**ï¼š
- å®éªŒç»„åç§°ï¼š`spurious_forgetting_induced`
- å†»ç»“ç­–ç•¥ï¼šå†»ç»“åº•å±‚30%å±‚
- é¢„æœŸç»“æœï¼šå¯¹é½åº¦ä¸‹é™ä¸»è¦å‘ç”Ÿåœ¨é¡¶å±‚ï¼Œå¯é€†æ€§åˆ†æ•°é«˜

### å®éªŒç»„3ï¼šçœŸå®é—å¿˜è¯±å¯¼ç»„ï¼ˆTrue Forgetting Induced Groupï¼‰

**å®éªŒç›®çš„**ï¼š
- é€šè¿‡é«˜å¼ºåº¦è®­ç»ƒæ–°ä»»åŠ¡ï¼ˆ10 epochsï¼‰ï¼Œæœ€å°åŒ–æ—§ä»»åŠ¡æ•°æ®ï¼Œè¯±å¯¼çœŸå®é—å¿˜
- éªŒè¯çœŸå®é—å¿˜çš„ç‰¹å¾ï¼šè¡¨ç¤ºç©ºé—´å˜åŒ–å¤§ï¼Œæ€§èƒ½ä¸‹é™å¤§
- éªŒè¯å¯é€†æ€§åˆ†æ•°åº”è¯¥è¾ƒä½ï¼ˆ<0.6ï¼‰

**è¿è¡Œå‘½ä»¤**ï¼š
```bash
python run_experiments.py \
  --models qwen2.5:3b \
  --datasets clinc150 \
  --experiment-groups true_forgetting_induced
```

**å…³é”®å‚æ•°**ï¼š
- å®éªŒç»„åç§°ï¼š`true_forgetting_induced`
- è®­ç»ƒç­–ç•¥ï¼šé«˜å¼ºåº¦è®­ç»ƒï¼ˆ10 epochsï¼‰
- é¢„æœŸç»“æœï¼šè¡¨ç¤ºç©ºé—´å‘ç”Ÿæ ¹æœ¬æ€§æ”¹å˜ï¼Œå¯é€†æ€§åˆ†æ•°ä½

### å®éªŒç»„4ï¼šæ··åˆé—å¿˜ç»„ï¼ˆMixed Forgetting Groupï¼‰

**å®éªŒç›®çš„**ï¼š
- éƒ¨åˆ†ä»»åŠ¡è¯±å¯¼è™šå‡é—å¿˜ï¼Œéƒ¨åˆ†ä»»åŠ¡è¯±å¯¼çœŸå®é—å¿˜
- éªŒè¯è¯†åˆ«æ–¹æ³•åœ¨å¤æ‚åœºæ™¯ä¸‹çš„è¡¨ç°
- éªŒè¯èƒ½å¤ŸåŒºåˆ†ä¸åŒç±»å‹çš„é—å¿˜

**è¿è¡Œå‘½ä»¤**ï¼š
```bash
python run_experiments.py \
  --models qwen2.5:3b \
  --datasets clinc150 \
  --experiment-groups mixed_forgetting
```

**å…³é”®å‚æ•°**ï¼š
- å®éªŒç»„åç§°ï¼š`mixed_forgetting`
- è®­ç»ƒç­–ç•¥ï¼šç»“åˆå†»ç»“å’Œé«˜å¼ºåº¦è®­ç»ƒ
- é¢„æœŸç»“æœï¼šè¯†åˆ«å‡†ç¡®ç‡ > 85%ï¼Œèƒ½å¤Ÿæ­£ç¡®åŒºåˆ†è™šå‡é—å¿˜å’ŒçœŸå®é—å¿˜

### å®éªŒç»„5ï¼šæ·±å±‚å¯¹é½è®­ç»ƒéªŒè¯ï¼ˆDeep Alignment Trainingï¼‰

**å®éªŒç›®çš„**ï¼š
- éªŒè¯æ·±å±‚å¯¹é½è®­ç»ƒï¼ˆDeep Alignment Trainingï¼‰çš„æœ‰æ•ˆæ€§
- éªŒè¯é€šè¿‡æ·±å±‚å¯¹é½è®­ç»ƒå¯ä»¥ç¼“è§£è™šå‡é—å¿˜

**è¿è¡Œå‘½ä»¤**ï¼š
```bash
# å¯ç”¨æ·±å±‚å¯¹é½è®­ç»ƒï¼ˆé»˜è®¤å¯ç”¨ï¼‰
python run_experiments.py \
  --models qwen2.5:3b \
  --datasets clinc150 \
  --experiment-groups deep_alignment_training \
  --use-deep-alignment
```

**å…³é”®å‚æ•°**ï¼š
- å®éªŒç»„åç§°ï¼š`deep_alignment_training`
- æ·±å±‚å¯¹é½é˜ˆå€¼ï¼šÏ„_deep = 0.7
- æ·±å±‚å¯¹é½æ·±åº¦ï¼šD > 10

### å®éªŒç»„6ï¼šæ¶ˆèå®éªŒï¼ˆAblation Studyï¼‰

**å®éªŒç›®çš„**ï¼šåˆ†æå„ä¸ªç»„ä»¶çš„è´¡çŒ®ï¼ŒéªŒè¯æ–¹æ³•è®¾è®¡çš„åˆç†æ€§

**è¿è¡Œå‘½ä»¤**ï¼š
```bash
# ä½¿ç”¨å•ä¸ªæ¨¡å‹å’Œå•ä¸ªæ•°æ®é›†è¿è¡Œæ¶ˆèå®éªŒ
python run_experiments.py \
  --models qwen2.5:3b \
  --datasets clinc150 \
  --experiment-groups ablation
```

**æ¶ˆèç»„ä»¶è¯´æ˜**ï¼š
1. **å®Œæ•´æ–¹æ³•**ï¼šæ‰€æœ‰ç»„ä»¶éƒ½ä½¿ç”¨
2. **æ— å¯¹é½åº¦æŒ‡æ ‡**ï¼šç§»é™¤å¯¹é½åº¦æŒ‡æ ‡ï¼Œä»…ä½¿ç”¨å¯é€†æ€§
3. **æ— å¯é€†æ€§æŒ‡æ ‡**ï¼šç§»é™¤å¯é€†æ€§æŒ‡æ ‡ï¼Œä»…ä½¿ç”¨å¯¹é½åº¦
4. **æ— åŠ¨æ€è·Ÿè¸ª**ï¼šä¸è·Ÿè¸ªè¡¨ç¤ºç©ºé—´ï¼Œä»…ä½¿ç”¨æœ€ç»ˆçŠ¶æ€
5. **å›ºå®šå†»ç»“ç­–ç•¥**ï¼šä½¿ç”¨å›ºå®š30%å†»ç»“ï¼Œä¸ä½¿ç”¨è‡ªé€‚åº”
6. **ä»…å¯¹é½åº¦æŒ‡æ ‡**ï¼šåªä½¿ç”¨å¯¹é½åº¦æŒ‡æ ‡
7. **ä»…å¯é€†æ€§æŒ‡æ ‡**ï¼šåªä½¿ç”¨å¯é€†æ€§æŒ‡æ ‡

### å®éªŒç»„åˆ—è¡¨

| å®éªŒç»„åç§° | è¯´æ˜ |
|-----------|------|
| `baseline_control` | åŸºçº¿å¯¹ç…§ç»„ï¼ˆæ ‡å‡†è®­ç»ƒï¼‰ |
| `spurious_forgetting_induced` | è™šå‡é—å¿˜è¯±å¯¼ç»„ï¼ˆå†»ç»“åº•å±‚30%ï¼‰ |
| `true_forgetting_induced` | çœŸå®é—å¿˜è¯±å¯¼ç»„ï¼ˆé«˜å¼ºåº¦è®­ç»ƒï¼‰ |
| `mixed_forgetting` | æ··åˆé—å¿˜ç»„ |
| `ablation` | æ¶ˆèå®éªŒç»„ |
| `deep_alignment_training` | æ·±å±‚å¯¹é½è®­ç»ƒéªŒè¯ç»„ |

---

## å®éªŒç»“æœ

### ç»“æœæ–‡ä»¶ä½ç½®

å®éªŒç»“æœä¿å­˜åœ¨ `./results/` ç›®å½•ä¸‹ï¼ŒåŒ…æ‹¬ï¼š

1. **å•ä¸ªå®éªŒç»“æœ**: `{model}_{dataset}_{group}_{timestamp}.json`
2. **æ€»ç»“æŠ¥å‘Š**: `summary_{timestamp}.json`

### ç»“æœæ ¼å¼

æ¯ä¸ªç»“æœæ–‡ä»¶åŒ…å«ï¼š

```json
{
  "model": "qwen2.5:3b",
  "dataset": "clinc150",
  "experiment_group": "baseline_control",
  "task_results": {
    "0": {
      "performance_before": 0.85,
      "performance_after": 0.82,
      "alignment_depth": 3,
      "reversibility_score": 0.75,
      "spurious_forgetting_score": 0.65,
      "forgetting_type": "spurious"
    }
  },
  "identification_accuracy": {
    "spurious": 0.89,
    "true": 0.87,
    "overall": 0.88
  },
  "metrics": {
    "average_accuracy": 0.764,
    "backward_transfer": -0.01
  }
}
```

### é¢„æœŸç»“æœ

1. **è¯†åˆ«å‡†ç¡®ç‡**ï¼šåº”è¯¥è¾¾åˆ°86.2%-90.6%
2. **å¯¹é½æ·±åº¦**ï¼š
   - æ ‡å‡†è®­ç»ƒï¼šD â‰¤ 3
   - æ·±å±‚å¯¹é½è®­ç»ƒï¼šD > 12
3. **é²æ£’æ€§æå‡**ï¼šæ·±å±‚å¯¹é½è®­ç»ƒåº”æå‡3.3%-7.1%

---

## å¸¸è§é—®é¢˜

### 1. Ollamaè¿æ¥å¤±è´¥

**é—®é¢˜**ï¼šæ— æ³•è¿æ¥åˆ°OllamaæœåŠ¡

**è§£å†³**ï¼š
```bash
# ç¡®ä¿OllamaæœåŠ¡æ­£åœ¨è¿è¡Œ
ollama serve

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:11434/api/tags
```

### 2. æ¨¡å‹ä¸å­˜åœ¨

**é—®é¢˜**ï¼šæ¨¡å‹æœªæ‰¾åˆ°

**è§£å†³**ï¼š
```bash
# æ‹‰å–ç¼ºå¤±çš„æ¨¡å‹
ollama pull qwen3:1.7b
ollama pull qwen2.5:3b
ollama pull qwen3:4b
ollama pull qwen2.5:32b

# æŸ¥çœ‹å·²å®‰è£…çš„æ¨¡å‹
ollama list
```

### 3. å†…å­˜ä¸è¶³

**é—®é¢˜**ï¼šè¿è¡Œ32Bæ¨¡å‹æ—¶å†…å­˜ä¸è¶³

**è§£å†³**ï¼š
- ä½¿ç”¨è¾ƒå°çš„æ¨¡å‹ï¼š`--models qwen2.5:3b`
- å‡å°‘batch_sizeï¼ˆåœ¨config.pyä¸­è®¾ç½®ï¼‰
- ä½¿ç”¨CPUæ¨¡å¼ï¼š`--device cpu`ï¼ˆè¾ƒæ…¢ï¼‰

### 4. CUDAä¸å¯ç”¨

**é—®é¢˜**ï¼šCUDAä¸å¯ç”¨

**å¸¸è§åŸå› å’Œè§£å†³æ–¹æ¡ˆ**ï¼š

1. **PyTorchå®‰è£…çš„æ˜¯CPUç‰ˆæœ¬ï¼ˆæœ€å¸¸è§ï¼‰**
   ```bash
   # å¸è½½CPUç‰ˆæœ¬
   pip uninstall torch torchvision torchaudio
   
   # å®‰è£…CUDAç‰ˆæœ¬ï¼ˆæ ¹æ®æ‚¨çš„CUDAç‰ˆæœ¬é€‰æ‹©ï¼‰
   # CUDA 11.8:
   pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
   
   # CUDA 12.1:
   pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
   
   # æŸ¥çœ‹æ‰€æœ‰ç‰ˆæœ¬: https://pytorch.org/get-started/locally/
   ```

2. **NVIDIAé©±åŠ¨æœªå®‰è£…**
   - ä¸‹è½½å¹¶å®‰è£…NVIDIAé©±åŠ¨: https://www.nvidia.com/Download/index.aspx
   - æ£€æŸ¥é©±åŠ¨: `nvidia-smi`

3. **æ²¡æœ‰NVIDIA GPU**
   - ä½¿ç”¨CPUæ¨¡å¼: `python run_experiments.py --device cpu`
   - æ³¨æ„ï¼šCPUæ¨¡å¼è¿è¡Œè¾ƒæ…¢ï¼Œä½†å¯ä»¥æ­£å¸¸å·¥ä½œ

### 5. å®éªŒè¿è¡Œæ—¶é—´è¿‡é•¿

**é—®é¢˜**ï¼šå®Œæ•´å®éªŒéœ€è¦å¾ˆé•¿æ—¶é—´

**è§£å†³**ï¼š
1. ä»…è¿è¡Œéƒ¨åˆ†æ¨¡å‹ï¼š`--models qwen2.5:3b`
2. ä»…è¿è¡Œéƒ¨åˆ†æ•°æ®é›†ï¼š`--datasets clinc150`
3. å‡å°‘ä»»åŠ¡æ•°é‡ï¼ˆåœ¨config.pyä¸­è®¾ç½® `num_tasks`ï¼‰

---

## é¡¹ç›®ç»“æ„

```
ç¾éš¾é—å¿˜/
â”œâ”€â”€ README_CN.md                 # é¡¹ç›®è¯´æ˜ï¼ˆæœ¬æ–‡ä»¶ï¼‰
â”œâ”€â”€ requirements.txt            # ä¾èµ–åŒ…
â”œâ”€â”€ config.py                   # é…ç½®æ–‡ä»¶
â”œâ”€â”€ main.py                     # ä¸»ç¨‹åºå…¥å£ï¼ˆæ—§æ¥å£ï¼‰
â”œâ”€â”€ run_experiments.py          # å®éªŒä¸»å…¥å£ â­
â”œâ”€â”€ data/                       # æ•°æ®å¤„ç†æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ datasets.py            # æ•°æ®é›†åŠ è½½
â”œâ”€â”€ models/                     # æ¨¡å‹å®šä¹‰
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ qwen_model.py          # Qwen2.5æ¨¡å‹ï¼ˆæœ¬åœ°å’ŒOllamaï¼Œå®éªŒä½¿ç”¨ï¼‰
â”‚   â””â”€â”€ base_model.py          # åŸºç¡€æ¨¡å‹ç±»
â”œâ”€â”€ metrics/                    # è¯„æµ‹æŒ‡æ ‡
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ alignment_score.py     # å¯¹é½åº¦æŒ‡æ ‡
â”‚   â”œâ”€â”€ reversibility.py       # å¯é€†æ€§æŒ‡æ ‡
â”‚   â”œâ”€â”€ forgetting_metrics.py  # é—å¿˜æŒ‡æ ‡
â”‚   â””â”€â”€ evaluation.py          # ç»¼åˆè¯„æµ‹
â”œâ”€â”€ analysis/                   # è¡¨ç¤ºç©ºé—´åˆ†æå·¥å…·
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ alignment_analyzer.py  # å¯¹é½åˆ†æå·¥å…·
â”‚   â”œâ”€â”€ reversibility_analyzer.py # å¯é€†æ€§åˆ†æå·¥å…·
â”‚   â”œâ”€â”€ representation_tracker.py # åŠ¨æ€è·Ÿè¸ªå·¥å…·
â”‚   â””â”€â”€ visualization.py       # å¯è§†åŒ–å·¥å…·
â”œâ”€â”€ strategies/                 # ç¼“è§£ç­–ç•¥
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ adaptive_freezing.py   # è‡ªé€‚åº”å†»ç»“ç­–ç•¥
â”‚   â”œâ”€â”€ alignment_repair.py    # å¯¹é½ä¿®å¤ç­–ç•¥
â”‚   â”œâ”€â”€ hybrid_strategy.py     # æ··åˆç­–ç•¥
â”‚   â””â”€â”€ baseline_methods.py    # åŸºçº¿æ–¹æ³•ï¼ˆEWC, SIç­‰ï¼‰
â”œâ”€â”€ experiments/                # å®éªŒè„šæœ¬
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main_experiment.py     # ä¸»å®éªŒè„šæœ¬ â­
â”‚   â””â”€â”€ spurious_forgetting_identification.py  # å®éªŒ1ï¼šè™šå‡é—å¿˜è¯†åˆ«
â”œâ”€â”€ training/                   # è®­ç»ƒæ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ deep_alignment_trainer.py # æ·±å±‚å¯¹é½è®­ç»ƒ â­
â”‚   â””â”€â”€ adaptive_mitigation.py  # è‡ªé€‚åº”ç¼“è§£ç­–ç•¥ â­
â”œâ”€â”€ utils/                      # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ logger.py              # æ—¥å¿—å·¥å…·
â”‚   â”œâ”€â”€ helpers.py             # è¾…åŠ©å‡½æ•°
â”‚   â””â”€â”€ ollama_helper.py       # Ollamaè¾…åŠ©å·¥å…·
â””â”€â”€ results/                    # å®éªŒç»“æœç›®å½•
    â””â”€â”€ (å®éªŒè¿è¡Œåè‡ªåŠ¨ç”Ÿæˆ)
```

---

## æ•°æ®é›†

æœ¬é¡¹ç›®ä½¿ç”¨ä»¥ä¸‹å¼€æºæ•°æ®é›†ï¼š

1. **Split-MNIST**: å°†MNISTæ•°æ®é›†åˆ†æˆ5ä¸ªä»»åŠ¡
2. **Permuted-MNIST**: MNISTçš„åƒç´ é‡æ’ç‰ˆæœ¬ï¼Œ10ä¸ªä»»åŠ¡
3. **Split-CIFAR-10**: å°†CIFAR-10åˆ†æˆ5ä¸ªä»»åŠ¡
4. **CLINC-150**: è‡ªç„¶è¯­è¨€ç†è§£æ•°æ®é›†ï¼Œ15ä¸ªæ„å›¾åˆ†ç±»ä»»åŠ¡
5. **20 Newsgroups**: æ–‡æœ¬åˆ†ç±»æ•°æ®é›†ï¼Œ5ä¸ªä»»åŠ¡

---

## æ”¯æŒçš„æ¨¡å‹

æœ¬å®éªŒä½¿ç”¨ä»¥ä¸‹Qwenæ¨¡å‹ï¼ˆé€šè¿‡Ollamaéƒ¨ç½²ï¼‰ï¼š

1. **Qwen3-1.7B** (`qwen3:1.7b`) - 1.7Bå‚æ•°
2. **Qwen2.5-3B** (`qwen2.5:3b`) - 3Bå‚æ•°
3. **Qwen3-4B** (`qwen3:4b`) - 4Bå‚æ•°
4. **Qwen2.5-32B** (`qwen2.5:32b`) - 32Bå‚æ•° â­ **æ¨è**

**ä½¿ç”¨Ollamaæ¨¡å‹çš„ä¼˜åŠ¿**ï¼š
- æ”¯æŒæ›´å¤§çš„æ¨¡å‹ï¼ˆå¦‚32Bï¼‰
- æ— éœ€æœ¬åœ°ä¸‹è½½å®Œæ•´æ¨¡å‹
- è‡ªåŠ¨GPUåŠ é€Ÿï¼ˆå¦‚æœå¯ç”¨ï¼‰
- æ›´çµæ´»çš„æ¨¡å‹ç®¡ç†

---

## è¯„æµ‹æŒ‡æ ‡

- **è¯†åˆ«å‡†ç¡®ç‡**: è™šå‡é—å¿˜å’ŒçœŸå®é—å¿˜çš„è¯†åˆ«å‡†ç¡®ç‡
- **å¯¹é½åº¦æŒ‡æ ‡**: ä»»åŠ¡å¯¹é½çš„é‡åŒ–åº¦é‡
- **å¯é€†æ€§æŒ‡æ ‡**: é—å¿˜å¯é€†æ€§çš„è¯„åˆ†
- **å¹³å‡å‡†ç¡®ç‡**: æ‰€æœ‰ä»»åŠ¡çš„å¹³å‡å‡†ç¡®ç‡
- **é—å¿˜ç‡**: æ—§ä»»åŠ¡çš„æ€§èƒ½ä¸‹é™ç‡
- **å‰å‘/åå‘è¿ç§»**: çŸ¥è¯†è¿ç§»æ•ˆæœ

---

## å‘½ä»¤è¡Œå‚æ•°

### å¸¸ç”¨å‚æ•°è¯´æ˜

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ | ç¤ºä¾‹ |
|------|------|--------|------|
| `--models` | è¦ä½¿ç”¨çš„æ¨¡å‹åˆ—è¡¨ | æ‰€æœ‰4ä¸ªæ¨¡å‹ | `--models qwen2.5:3b` |
| `--datasets` | è¦ä½¿ç”¨çš„æ•°æ®é›† | `clinc150 20newsgroups` | `--datasets clinc150` |
| `--experiment-groups` | è¦è¿è¡Œçš„å®éªŒç»„ | æ‰€æœ‰ç»„ | `--experiment-groups baseline_control` |
| `--device` | è®¡ç®—è®¾å¤‡ | `cuda` | `--device cpu` |
| `--use-deep-alignment` | å¯ç”¨æ·±å±‚å¯¹é½è®­ç»ƒ | `True` | `--use-deep-alignment` |
| `--no-deep-alignment` | ç¦ç”¨æ·±å±‚å¯¹é½è®­ç»ƒ | - | `--no-deep-alignment` |
| `--use-hybrid-strategy` | å¯ç”¨æ··åˆç¼“è§£ç­–ç•¥ | `True` | `--use-hybrid-strategy` |
| `--no-hybrid-strategy` | ç¦ç”¨æ··åˆç¼“è§£ç­–ç•¥ | - | `--no-hybrid-strategy` |
| `--ollama-url` | OllamaæœåŠ¡åœ°å€ | `http://localhost:11434` | `--ollama-url http://localhost:11434` |
| `--check-ollama` | ä»…æ£€æŸ¥Ollamaè®¾ç½® | - | `--check-ollama` |

### æŸ¥çœ‹å¸®åŠ©

```bash
python run_experiments.py --help
```

---

## æ¨èè¿è¡Œæµç¨‹

### é¦–æ¬¡è¿è¡Œ

```bash
# 1. æ£€æŸ¥ç¯å¢ƒ
python run_experiments.py --check-ollama

# 2. è¿è¡Œå°è§„æ¨¡æµ‹è¯•ï¼ˆä½¿ç”¨å°æ¨¡å‹ï¼‰
python run_experiments.py --models qwen2.5:3b --datasets clinc150

# 3. å¦‚æœæµ‹è¯•æˆåŠŸï¼Œè¿è¡Œå®Œæ•´å®éªŒ
python run_experiments.py
```

### æ—¥å¸¸è¿è¡Œ

```bash
# ç›´æ¥è¿è¡Œå®éªŒ
python run_experiments.py
```

### æç¤º

- é¦–æ¬¡è¿è¡Œå»ºè®®å…ˆä½¿ç”¨å°æ¨¡å‹ï¼ˆå¦‚ `qwen2.5:3b`ï¼‰æµ‹è¯•
- å®Œæ•´å®éªŒå¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´ï¼Œå»ºè®®åœ¨åå°è¿è¡Œ
- ç»“æœä¼šè‡ªåŠ¨ä¿å­˜ï¼Œå¯ä»¥éšæ—¶ä¸­æ–­å’Œæ¢å¤
- å¦‚æœé‡åˆ°é—®é¢˜ï¼Œå…ˆè¿è¡Œ `--check-ollama` æ£€æŸ¥ç¯å¢ƒ

